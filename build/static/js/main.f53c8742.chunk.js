(this.webpackJsonpblog_frontend=this.webpackJsonpblog_frontend||[]).push([[0],{149:function(e,t,n){e.exports={navBar:"NavBar_navBar__36P4w"}},150:function(e,t,n){e.exports={editorClassName:"Editor_editorClassName__3DS5i","rdw-image-modal":"Editor_rdw-image-modal__6Upd_"}},151:function(e,t,n){e.exports={main:"PostPrev_main__1cGXT",textWrapper:"PostPrev_textWrapper__2D_1c"}},259:function(e,t,n){e.exports={main:"CommentForm_main__1JUni","shadow-textarea":"CommentForm_shadow-textarea__383J3","form-control":"CommentForm_form-control__Um0CK"}},266:function(e,t,n){e.exports={main:"Loader_main__gFDWN"}},267:function(e,t,n){e.exports={noPost:"Posts_noPost__2-UrU"}},268:function(e,t,n){e.exports={auth:"Authorization_auth__UYznG",buttons:"Authorization_buttons__2bA4G","alert-danger":"Authorization_alert-danger__1S7d8"}},271:function(e,t,n){e.exports={main:"Toggle_main__2zxx1"}},275:function(e,t,n){e.exports=n(592)},280:function(e,t,n){},281:function(e,t,n){},398:function(e,t,n){},435:function(e,t){},49:function(e,t,n){e.exports={postedBy:"PostInfo_postedBy__MwY5d",main:"PostInfo_main__3aZXP",like:"PostInfo_like__iu0IY",comment:"PostInfo_comment__OtLV9",picLink:"PostInfo_picLink__3uS9M",buttons:"PostInfo_buttons__1NVcs"}},58:function(e,t,n){e.exports={postBody:"SinglePost_postBody__3cVcm",buttons:"SinglePost_buttons__m3DAc",editing:"SinglePost_editing__3X0B2",wrap:"SinglePost_wrap__1JQuz",errors:"SinglePost_errors__3g1NU"}},592:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),s=n(28),o=n.n(s),c=(n(280),n(281),n(48)),i=n(3),u=n.n(i),l=n(15),m=n(16),p=n(13),d=n(10),f=n(11),h=n(12),v=n(58),b=n.n(v),g=n(70),E=n.n(g),_=n(8),k=n(255),O=n(106);function C(e){var t=e.comments,n=e.adminPanel,a=e.userId,s=e.isAdmin,o=e.approveCommentHandler,c=e.removeCommentHandler;return r.a.createElement("div",{className:E.a.main},t.map((function(e,t){return(!n&&e.approved||n&&!e.approved)&&r.a.createElement("div",{key:t,className:E.a.comment},r.a.createElement(_.b,{to:"/users/".concat(e.owner._id)},e.owner.login," :"),r.a.createElement("span",null,e.text),(e.owner._id===a||n||s)&&r.a.createElement("div",{className:E.a.buttons},!e.approved&&r.a.createElement("button",{className:E.a.remove,onClick:function(){return o(e._id)}},r.a.createElement(O.a,null)),r.a.createElement("button",{className:E.a.remove,onClick:function(){return c(e._id)}},r.a.createElement(k.a,null))))})))}var y=n(32),w=n.n(y),P=n(256),x=n.n(P),j={baseURL:Object({NODE_ENV:"production",PUBLIC_URL:""}).SERVER_URL},S=x.a.create(j);S.interceptors.request.use((function(e){var t=localStorage.getItem("userInfo");return(t=JSON.parse(t)).token?(e.headers={Authorization:"Bearer "+t.token},e):e}));var H=S;function I(e,t){var n="";if(e.response&&400===e.response.status)switch(e.response.data){case"Validation error":n="You must stick with validation rules";break;case"Invalid token":n="Your token is invalid";break;default:n="Something went wrong"}w.a.fire({icon:"error",title:t,text:n,showConfirmButton:!0,timer:6e3})}var N="FETCH_POSTS_START",F="FETCH_POSTS_SUCCESS",T="FETCH_SINGLE_POST_START",A="FETCH_SINGLE_POST_SUCCESS",L="FETCH_SINGLE_POST_ERROR",R="SET_USER_INFO",B="ADD_COMMENT",M="REMOVE_COMMENT_ACTION",U="ADD_LIKE",D="REMOVE_LIKE",z="LOG_OUT",V="UPDATE_POST",Y="GET_USER",J="SET_USER",G="GET_COMMENTS",X="REMOVE_COMMENT",W="APPROVE_COMMENT";function q(e){return function(t){var n;return u.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,u.a.awrap(H.get("/posts/".concat(e)));case 3:n=a.sent,t((r=n.data,{type:A,singlePost:r})),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),I(a.t0,"Fetch single post error");case 10:case"end":return a.stop()}var r}),null,null,[[0,7]])}}function K(){return function(e){var t;return u.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return e({type:N}),n.prev=1,n.next=4,u.a.awrap(H.get("/posts"));case 4:t=n.sent,e((a=t.data,{type:F,posts:a})),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(1),I(n.t0,"Fetch posts error");case 11:case"end":return n.stop()}var a}),null,null,[[1,8]])}}function Z(e){return{type:U,like:e}}function Q(e,t){return function(n){var a,r;return u.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,a={postId:e},s.next=4,u.a.awrap(H.post("/like",a));case 4:r=s.sent,n(t?(o=r.data,{type:D,like:o}):Z(r.data)),s.next=12;break;case 8:return s.prev=8,s.t0=s.catch(0),I(s.t0,"You have to login first"),s.abrupt("return",s.t0);case 12:case"end":return s.stop()}var o}),null,null,[[0,8]])}}function $(e,t,n){var a,r;return u.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,a={title:e,subtitle:t,text:n},s.next=4,u.a.awrap(H.post("/posts/",a));case 4:return r=s.sent,w.a.fire({icon:"success",title:"Your post is on check by admin",showConfirmButton:!1,timer:2e3}),s.abrupt("return",r);case 9:s.prev=9,s.t0=s.catch(0),I(s.t0,"Creating post error");case 12:case"end":return s.stop()}}),null,null,[[0,9]])}function ee(e){var t;return u.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,(t=new FormData).append("pics",e),n.next=5,u.a.awrap(H.post("/upload",t));case 5:return n.abrupt("return",n.sent);case 8:n.prev=8,n.t0=n.catch(0),I(n.t0,"Image uploading error");case 11:case"end":return n.stop()}}),null,null,[[0,8]])}function te(e){return function(t){return u.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,u.a.awrap(H.delete("/posts/".concat(e)));case 3:t(K()),w.a.fire({icon:"success",title:"This post is successfully removed",showConfirmButton:!1,timer:2e3}),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),I(n.t0,"Post remove error");case 10:case"end":return n.stop()}}),null,null,[[0,7]])}}function ne(e){return{type:X,id:e}}function ae(e){return{type:W,id:e}}var re=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(p.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).removeCommentFromSinglePostHandler=function(e){n.props.removeCommentFromSinglePostHandler(e)},n.removeCommentFromAdminHandler=function(e){n.props.removeCommentFromAdminHandler(e)},n.approveCommentHandler=function(e){n.props.approveComment(e)},n}return Object(f.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){this.props.adminPanel&&this.props.getComments()}},{key:"render",value:function(){return r.a.createElement(C,{removeCommentHandler:this.props.adminPanel?this.removeCommentFromAdminHandler:this.removeCommentFromSinglePostHandler,comments:this.props.adminPanel?this.props.comments:this.props.singlePost.comments,userId:this.props.userId,isAdmin:this.props.user.isAdmin,adminPanel:this.props.adminPanel})}}]),t}(a.Component);var se=Object(h.b)((function(e){return{singlePost:e.posts.singlePost,userId:e.auth.userId,user:e.auth.user,comments:e.comments.comments}}),(function(e){return{removeCommentFromSinglePostHandler:function(t){return e(function(e){return function(t){var n;return u.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,u.a.awrap(H.delete("/comment/".concat(e)));case 3:n=a.sent,t((r=n.data,{type:M,comment:r})),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),I(a.t0,"Remove comment error");case 10:case"end":return a.stop()}var r}),null,null,[[0,7]])}}(t))},removeCommentFromAdminHandler:function(t){return e(function(e){return function(t){return u.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,u.a.awrap(H.delete("/comment/".concat(e)));case 3:t(ne(e)),n.next=9;break;case 6:n.prev=6,n.t0=n.catch(0),console.error("Remove comment error",n.t0);case 9:case"end":return n.stop()}}),null,null,[[0,6]])}}(t))},approveComment:function(t){return e(function(e){return function(t){return u.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,u.a.awrap(H.put("/comment/".concat(e),{}));case 3:t(ae(e)),n.next=9;break;case 6:n.prev=6,n.t0=n.catch(0),console.error("Approve comment error",n.t0);case 9:case"end":return n.stop()}}),null,null,[[0,6]])}}(t))},getComments:function(){return e((function(e){var t;return u.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,u.a.awrap(H.get("/comments"));case 3:t=n.sent,e((a=t.data,{type:G,comments:a})),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),console.error("get all comments error: ",n.t0);case 10:case"end":return n.stop()}var a}),null,null,[[0,7]])}))}}}))(re),oe=n(79),ce=n.n(oe),ie=n(149),ue=n.n(ie);function le(e,t){return{type:R,payload:{token:e,userId:t}}}function me(){return function(e){localStorage.setItem("userInfo",JSON.stringify({})),localStorage.setItem("user",JSON.stringify({})),e({type:z}),e(pe({})),w.a.fire({icon:"success",title:"You are successfully logged out",showConfirmButton:!1,timer:2e3})}}function pe(e){return{type:J,user:e}}var de=n(46),fe=n(80),he=n.n(fe),ve=n(258),be=n(257),ge=function(e,t){var n=function(n){e.current&&!e.current.contains(n.target)&&t()};Object(a.useEffect)((function(){return document.addEventListener("click",n),function(){document.removeEventListener("click",n)}}))},Ee=n.n(be)()((function(e){var t=e.windowWidth,n=e.isLoggedIn,s=e.isAdmin,o=e.logOut,c=Object(a.useState)(!0),i=Object(de.a)(c,2),u=i[0],l=i[1],m=Object(a.useRef)();return Object(a.useEffect)((function(){t<768&&l(!1)}),[t]),ge(m,(function(){u&&l(!u)})),r.a.createElement("div",{className:he.a.main},t<768&&!u&&r.a.createElement("button",{className:he.a.burger,onClick:function(){return l(!0)}},r.a.createElement(ve.a,null)),r.a.createElement("ul",{ref:m,className:he.a.links,style:t>768?{width:"auto"}:u?{width:"200px"}:{width:"0px"}},u&&t<768&&r.a.createElement("li",null,r.a.createElement("button",{className:he.a.close,onClick:function(){return l(!1)}},"x")),r.a.createElement("li",null,r.a.createElement(_.b,{exact:!0,to:"/"},"HOME")),n&&r.a.createElement("li",null,r.a.createElement(_.b,{to:"/post-edit/5ded74cb4323972c772c37a9"},"ADD POST")),n&&r.a.createElement("li",null,r.a.createElement(_.b,{to:"/my-posts"},"MY POSTS")),r.a.createElement("li",null,s&&r.a.createElement(_.b,{to:"/admin"},"ADMIN")),r.a.createElement("li",null,n?r.a.createElement(_.b,{to:"/",onClick:function(){return o()}},"LOG OUT"):r.a.createElement(_.b,{to:"/authorization"},"AUTHORIZATION"))))})),_e=function(e){function t(){return Object(l.a)(this,t),Object(p.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:ue.a.main},r.a.createElement("nav",{className:ue.a.navBar},r.a.createElement("div",null,r.a.createElement(_.b,{exact:!0,to:"/"},"Your diary")),r.a.createElement(Ee,{isAdmin:this.props.user.isAdmin,isLoggedIn:this.props.isLoggedIn,logOut:this.props.logOut})))}}]),t}(a.Component);var ke=Object(h.b)((function(e){return{isLoggedIn:e.auth.isLoggedIn,user:e.auth.user}}),(function(e){return{logOut:function(){return e(me())}}}))(_e);function Oe(e){var t=e.editing,n=e.onChangeHandler,a=e.title,s=e.subtitle;return r.a.createElement("div",{className:ce.a.main},r.a.createElement(ke,null),r.a.createElement("div",null,t?r.a.createElement("input",{placeholder:"Title",className:ce.a.h1,type:"text",value:a,onChange:function(e){return n("title",e.target.value)}}):r.a.createElement("h1",null,a),r.a.createElement("hr",{className:ce.a.small}),t?r.a.createElement("input",{placeholder:"Subtitle",className:ce.a.p,type:"text",value:s,onChange:function(e){return n("subtitle",e.target.value)}}):r.a.createElement("p",null,s)))}var Ce=n(49),ye=n.n(Ce),we=n(41);function Pe(e){var t=e.split("T");return t[1]=t[1].slice(0,-8),t.reverse().join(" ")}var xe=function(e){var t=e.disabled,n=e.commentClickHandler,a=e.isLiked,s=e.post,o=e.likeClickHandler;function c(e){switch(e){case"comment":return t?r.a.createElement(_.b,{className:ye.a.picLink,to:"/post/".concat(s._id)},r.a.createElement(we.b,null)):r.a.createElement("div",{onClick:n},r.a.createElement(we.b,null));case"like":return t?a?r.a.createElement(_.b,{className:ye.a.picLink,to:"/post/".concat(s._id)},r.a.createElement(we.a,null)):r.a.createElement(_.b,{className:ye.a.picLink,to:"/post/".concat(s._id)},r.a.createElement(we.c,null)):a?r.a.createElement("div",{onClick:function(){o(s._id)}},r.a.createElement(we.a,null)):r.a.createElement("div",{onClick:function(){o(s._id)}},r.a.createElement(we.c,null));default:return null}}return r.a.createElement("div",{className:ye.a.main},r.a.createElement("p",{className:ye.a.postedBy},"Posted by ",r.a.createElement(_.b,{to:"/user-posts/".concat(s.owner._id)},s.owner.login)," ",s.updatedAt&&s.created_at.slice(0,16)!==s.updatedAt.slice(0,16)?"updated ":"","at ",s.updatedTime?Pe(s.updatedAt):Pe(s.created_at)),r.a.createElement("span",{className:ye.a.comment},r.a.createElement("span",null,s.comments.filter((function(e){return e.approved})).length)," ",c("comment")),r.a.createElement("span",{className:ye.a.like},r.a.createElement("span",null,s.likes.length),c("like")),r.a.createElement("hr",null))},je=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(p.a)(this,Object(d.a)(t).call(this,e))).likeClickHandler=function(e){var t;return u.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,u.a.awrap(n.props.like(e,n.props.isLiked));case 2:t=a.sent,n.setState({isLiked:!n.state.isLiked}),t&&setTimeout((function(){return n.props.history.push("/authorization")}),2e3);case 5:case"end":return a.stop()}}))},n.state={isLiked:n.props.post.likes.some((function(e){return e.owner===n.props.userId}))},n}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement(xe,{disabled:this.props.disabled,likeClickHandler:this.likeClickHandler,isLiked:this.props.isLiked,post:this.props.post,commentClickHandler:this.props.commentClickHandler})}}]),t}(a.Component);var Se=Object(h.b)((function(e){return{}}),(function(e){return{like:function(t,n){return e(Q(t,n))}}}))(je),He=n(259),Ie=n.n(He);function Ne(e){var t=Object(a.useState)(""),n=Object(de.a)(t,2),s=n[0],o=n[1];return r.a.createElement("div",{className:Ie.a.main},r.a.createElement("div",{className:"form-group shadow-textarea"},r.a.createElement("textarea",{value:s,className:"form-control z-depth-1",id:"exampleFormControlTextarea6",rows:"3",placeholder:"Write your comment here...",onChange:function(e){return o(e.target.value)}})),r.a.createElement("div",{className:"col-auto"},r.a.createElement("button",{type:"submit",className:"btn btn-primary mb-2",onClick:function(){e.submitHandler(s),o(" ")}},"Send")))}var Fe=n(68),Te=n(260),Ae=(n(398),n(261)),Le=n.n(Ae),Re=n(262),Be=n.n(Re),Me=n(150),Ue=n.n(Me),De=function(e){var t=Object(a.useState)(""),n=Object(de.a)(t,2),s=n[0],o=n[1];return Object(a.useEffect)((function(){var t=Be()(e.body),n=Fe.ContentState.createFromBlockArray(t.contentBlocks),a=Fe.EditorState.createWithContent(n);o(a)}),[e.body]),r.a.createElement(Te.Editor,{onBlur:e.onBlurHandler,editorState:s,toolbar:{image:{alignmentEnabled:!1,uploadEnabled:!0,uploadCallback:function(t){return function(t){var n;return u.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,u.a.awrap(ee(t,e.token));case 2:return n=a.sent,a.abrupt("return",{data:{link:n.data.src}});case 4:case"end":return a.stop()}}))}(t)},inputAccept:"image/jpeg,image/jpg,image/png",previewImage:!0},fontSize:{options:[8,9,10,11,12,14,16,18,24,30,36]}},wrapperClassName:Ue.a.wrapperClassName,editorClassName:Ue.a.editorClassName,onEditorStateChange:function(t){o(t),e.onChangeHandler("text",Le()(Object(Fe.convertToRaw)(t.getCurrentContent())))},uploadEnabled:!0})},ze=n(263),Ve=n.n(ze);function Ye(e){return(new(0,Ve.a.Parser)).parse(e)}var Je=function(e){var t=e.isEditing,n=e.post,a=e.subtitle,s=e.title,o=e.onChangeHandler,c=e.token,i=e.isCreating,u=e.submited,l=e.errors,m=e.onSave,p=e.user,d=e.userId,f=e.commentClickHandler,h=e.isCommentsOpened,v=e.postRemoveHandler,g=e.submitHandler,E=[b.a.postBody];return t&&E.push(b.a.editing),n.title?r.a.createElement("div",{className:b.a.main},r.a.createElement(Oe,{subtitle:t?a:n.subtitle,title:t?s:n.title,onChangeHandler:o,editing:t}),r.a.createElement("div",{className:E.join(" ")},t?r.a.createElement("div",null,r.a.createElement(De,{token:c,body:i?" ":n.text,onChangeHandler:o}),r.a.createElement("ul",{className:b.a.errors},u&&Object.values(l).map((function(e,t){return!1!==e&&r.a.createElement("li",{key:t,className:"alert alert-danger"},e)}))),r.a.createElement("button",{type:"button",className:"btn btn-success",onClick:function(){return m(n)}},"Save")):r.a.createElement("div",null,r.a.createElement("div",{className:b.a.wrap},Ye(n.text)),r.a.createElement(Se,{post:n,userId:d,commentClickHandler:f})),!t&&h&&r.a.createElement(se,null),!t&&(p.isAdmin||n.owner._id===d)&&r.a.createElement("div",{className:b.a.buttons},r.a.createElement(_.b,{type:"button",className:"btn btn-success",to:"/post-edit/".concat(n._id)},"Edit"),r.a.createElement(_.b,{type:"button",className:"btn btn-danger",onClick:function(){return v()},to:"/"},"Remove")),!t&&r.a.createElement(Ne,{submitHandler:g}))):null},Ge=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(p.a)(this,Object(d.a)(t).call(this,e))).submitHandler=function(e){var t;return u.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,u.a.awrap(n.props.setComment(n.props.match.params.id,e));case 2:t=a.sent,n.setState({isCommentsOpened:!0}),t&&setTimeout((function(){return n.props.history.push("/authorization")}),2e3);case 5:case"end":return a.stop()}}))},n.commentClickHandler=function(){return n.setState({isCommentsOpened:!n.state.isCommentsOpened})},n.postRemoveHandler=function(){n.props.removePost(n.props.singlePost._id)},n.state={isCommentsOpened:!1},n}return Object(f.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){this.props.match?this.props.fetchSinglePost(this.props.match.params.id):this.props.fetchSinglePost(this.props.id)}},{key:"render",value:function(){return r.a.createElement(Je,{errors:this.props.errors,submited:this.props.submited,onChangeHandler:this.props.onChangeHandler,onSave:this.props.onSave,postId:this.props.postId,createPostHandler:this.props.createPostHandler,isCreating:this.props.isCreating,user:this.props.user,postRemoveHandler:this.postRemoveHandler,updatePostHandler:this.props.updatePostHandler,subtitle:this.props.subtitle,title:this.props.title,text:this.props.text,isEditing:this.props.isEditing,post:this.props.singlePost,userId:this.props.userId,commentClickHandler:this.commentClickHandler,token:this.props.token,isCommentsOpened:this.state.isCommentsOpened,isNewCommentPosted:this.state.isNewCommentPosted,removeCommentHandler:this.removeCommentHandler,submitHandler:this.submitHandler,likeClickHandler:this.likeClickHandler})}}]),t}(a.Component);var Xe=Object(h.b)((function(e){return{singlePost:e.posts.singlePost,userId:e.auth.userId,token:e.auth.token,user:e.auth.user}}),(function(e){return{fetchSinglePost:function(t){return e(q(t))},removePost:function(t){return e(te(t))},setComment:function(t,n){return e(function(e,t){return function(n){var a;return u.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,u.a.awrap(H.post("/comments",{text:t,postId:e}));case 3:a=r.sent,n((s=a.data,{type:B,comment:s})),w.a.fire({icon:"success",title:"Your comment is on check by admin",showConfirmButton:!1,timer:2e3}),r.next=12;break;case 8:return r.prev=8,r.t0=r.catch(0),I(r.t0,"You have to login first"),r.abrupt("return",r.t0);case 12:case"end":return r.stop()}var s}),null,null,[[0,8]])}}(t,n))}}}))(Ge),We=n(151),qe=n.n(We),Ke=n(264);function Ze(e){var t=e.post,n=e.admin,a=e.onRemoveHandle,s=e.onApproveHandle,o=e.likeClickHandler,c=e.userId,i=r.a.createElement("div",{className:qe.a.main},r.a.createElement(_.b,{to:"/post/".concat(t._id)},r.a.createElement("h1",null,t.title),r.a.createElement("div",{className:qe.a.textWrapper},Ye(t.text))),r.a.createElement(Se,{disabled:!0,post:t,userId:c,likeClickHandler:o}),n&&r.a.createElement("div",null,r.a.createElement("button",{type:"button",className:"btn btn-danger",onClick:function(){return a(t._id)}},r.a.createElement(Ke.a,null)),r.a.createElement("button",{type:"button",className:"btn btn-success",onClick:function(){return s(t._id)}},r.a.createElement(O.a,null))));return n?!t.approved&&i:t.approved&&i}var Qe=n(265),$e=n.n(Qe),et=n(266),tt=n.n(et),nt=function(){return r.a.createElement("div",{className:tt.a.main},r.a.createElement($e.a,{type:"Puff",color:"#333333",height:100,width:100}))},at=n(267),rt=n.n(at),st=function(e){return e.loading?r.a.createElement(nt,null):r.a.createElement("div",null,e.posts.filter((function(e){return null!==e.approved})).length?e.posts.map((function(t,n){return r.a.createElement(Ze,{onApproveHandle:e.onApproveHandle,onRemoveHandle:e.onRemoveHandle,admin:e.admin,key:n,post:t,userId:e.userId,likeClickHandler:e.likeClickHandler})})):r.a.createElement("div",{className:rt.a.noPost},r.a.createElement("h1",null,"You have no published posts yet"),r.a.createElement("hr",null),r.a.createElement(_.b,{type:"button",className:"btn btn-primary",to:"/post-edit/5ded74cb4323972c772c37a9"},"ADD POST")))},ot=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(p.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).likeClickHandler=function(e,t){n.props.like(e,t)},n}return Object(f.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchPosts()}},{key:"render",value:function(){var e=this.props,t=e.userId,n=e.posts,a=e.home,s=e.loading,o=e.admin,c=this.props.id||t,i=a?o?n.filter((function(e){return null===e.approved})):n:n.filter((function(e){return e.owner._id===c}));return n.length?r.a.createElement(st,{onApproveHandle:this.props.onApproveHandle,onRemoveHandle:this.props.onRemoveHandle,admin:o,loading:s,likeClickHandler:this.likeClickHandler,posts:i,userId:t}):r.a.createElement("h1",null,"It looks like the server is offline")}}]),t}(a.Component);var ct=Object(h.b)((function(e){return{posts:e.posts.posts,loading:e.posts.loading,userId:e.auth.userId,user:e.auth.user}}),(function(e){return{fetchPosts:function(){return e(K())},like:function(t,n){return e(Q(t,n))}}}))(ot),it=function(){return r.a.createElement("div",null,r.a.createElement(Oe,{title:"Clean Blog",subtitle:"A Clean Blog Theme by Start Bootstrap"}),r.a.createElement(ct,{home:!0}))},ut=function(){return r.a.createElement("div",null,r.a.createElement(Oe,{title:"My posts",subtitle:"Here you can see your posts"}),r.a.createElement(ct,null))},lt=n(153),mt=n(69),pt=n(7);var dt=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(p.a)(this,Object(d.a)(t).call(this,e))).onChangeHandler=function(e,t){var a;n.setState((a={},Object(mt.a)(a,e,t),Object(mt.a)(a,"errors",Object(pt.a)({},n.state.errors,Object(mt.a)({},e,!function(e,t){var n={text:function(e){return e.replace(/<.+?>/g,"").length<=2e3&&e.replace(/<.+?>/g,"").length>=100},title:function(e){return e.length<=60&&e.length>=3},subtitle:function(e){return e.length<=80}};return n[e]&&n[e](t)}(e,t)&&"".concat(e," lenght is not valid")))),a))},n.updatePostHandler=function(){n.props.updatePost(n.state.title,n.state.subtitle,n.state.text.replace(Object(lt.a)(/<(.*?)[\0-=\?-\uFFFF]*>(([\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*?)|(<\/?[\0-=\?-\uFFFF]*>)|(&[\0-:<-\uFFFF]*;))<\/\1>/gi,{tag:1}),""),n.props.singlePost._id),n.props.history.push("/post/".concat(n.props.singlePost._id))},n.createPostHandler=function(){var e;return u.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.a.awrap($(n.state.title,n.state.subtitle,n.state.text.replace(Object(lt.a)(/<(.*?)[\0-=\?-\uFFFF]*>(([\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*?)|(<\/?[\0-=\?-\uFFFF]*>)|(&[\0-:<-\uFFFF]*;))<\/\1>/gi,{tag:1}),"")));case 2:e=t.sent,n.props.history.push("/post/".concat(e.data._id));case 4:case"end":return t.stop()}}))},n.onSave=function(e){n.setState({submited:!0}),Object.values(n.state.errors).filter((function(e){return!1!==e})).length||("5ded74cb4323972c772c37a9"===e._id?n.createPostHandler():n.updatePostHandler())},n.state={text:"",subtitle:"",title:"",isCreating:"5ded74cb4323972c772c37a9"===n.props.match.params.id,errors:{},submited:!1},n}return Object(f.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){return u.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.match){e.next=5;break}return e.next=3,u.a.awrap(this.props.fetchSinglePost(this.props.match.params.id));case 3:e.next=7;break;case 5:return e.next=7,u.a.awrap(this.props.fetchSinglePost(this.props.id));case 7:this.setState({text:this.state.isCreating?" ":this.props.singlePost.text,subtitle:this.props.singlePost.subtitle,title:this.props.singlePost.title});case 8:case"end":return e.stop()}}),null,this)}},{key:"render",value:function(){return r.a.createElement(Xe,{errors:this.state.errors,submited:this.state.submited,onSave:this.onSave,postId:this.state.postId,createPostHandler:this.createPostHandler,updatePostHandler:this.updatePostHandler,subtitle:this.state.subtitle,title:this.state.title,setSubtitle:this.setSubtitle,setTitle:this.setTitle,text:this.state.text,onChangeHandler:this.onChangeHandler,isEditing:!0,isCreating:this.state.isCreating,id:this.props.match.params.id})}}]),t}(a.Component);var ft=Object(h.b)((function(e){return{singlePost:e.posts.singlePost}}),(function(e){return{fetchSinglePost:function(t){return e(q(t))},updatePost:function(t,n,a,r){return e(function(e,t,n,a){return function(r){var s;return u.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,s={title:e,subtitle:t,text:n},o.next=4,u.a.awrap(H.put("/posts/".concat(a),s));case 4:r({type:V,data:s}),w.a.fire({icon:"success",title:"Your post is on check by admin",showConfirmButton:!1,timer:2e3}),o.next=11;break;case 8:o.prev=8,o.t0=o.catch(0),I(o.t0,"Updating post error");case 11:case"end":return o.stop()}}),null,null,[[0,8]])}}(t,n,a,r))}}}))(dt),ht=n(268),vt=n.n(ht),bt=n(81),gt=n(606),Et=n(271),_t=n.n(Et);function kt(e){return r.a.createElement("div",{className:_t.a.main},r.a.createElement("span",null,e.left),r.a.createElement(gt.a,{disableRipple:!0,checked:e.isChecked,onChange:function(){return e.setIsChecked()}}),r.a.createElement("span",null,e.right))}var Ot=function(e){var t=Object(a.useState)(!1),n=Object(de.a)(t,2),s=n[0],o=n[1];return r.a.createElement("div",null,r.a.createElement(Oe,{title:"Authorization"}),r.a.createElement(kt,{isChecked:s,setIsChecked:function(){return o(!s)},left:"Log in",right:"Sign up"}),r.a.createElement("div",{className:vt.a.auth},r.a.createElement(bt.c,{initialValues:{login:"",password:""},validationSchema:e.signupSchema,onSubmit:function(t){s?e.registerButtonHandler(t):e.loginButtonHandler(t)},isValid:!1},(function(e){var t=e.errors,n=e.touched,a=e.isValid;return r.a.createElement(bt.b,null,r.a.createElement("label",{htmlFor:"usr"},"Login:"),r.a.createElement(bt.a,{name:"login",className:"form-control"}),t.login&&n.login?r.a.createElement("div",{className:"alert alert-danger"},t.login):r.a.createElement("br",null),r.a.createElement("label",{htmlFor:"pwd"},"Password:"),r.a.createElement(bt.a,{name:"password",className:"form-control",type:"password"}),t.password&&n.password?r.a.createElement("div",{className:"alert alert-danger"},t.password):r.a.createElement("br",null),s?r.a.createElement("button",{type:"submit",className:"btn btn-primary",disabled:!a},"Sign up"):r.a.createElement("button",{type:"submit",className:"btn btn-info",disabled:!a},"Log in"))}))))},Ct=n(109),yt=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(p.a)(this,Object(d.a)(t).call(this,e))).registerButtonHandler=function(e){var t,a;return u.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.login,a=e.password,r.next=3,u.a.awrap(n.props.registerUser(t,a));case 3:setTimeout((function(){return n.props.history.push("/")}),2e3);case 4:case"end":return r.stop()}}))},n.loginButtonHandler=function(e){var t,a;return u.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.login,a=e.password,r.next=3,u.a.awrap(n.props.loginUser(t,a));case 3:setTimeout((function(){return n.props.history.push("/")}),2e3);case 4:case"end":return r.stop()}}))},n.state={login:"",password:""},n}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=Ct.object().shape({login:Ct.string().min(5,"Too Short!").max(16,"Too Long!").required("Required"),password:Ct.string().min(5,"Too Short!").max(32,"Too Long!").required("Required")});return r.a.createElement(Ot,{registerButtonHandler:this.registerButtonHandler,loginButtonHandler:this.loginButtonHandler,login:this.state.login,password:this.state.password,signupSchema:e})}}]),t}(a.Component);var wt=Object(h.b)(null,(function(e){return{loginUser:function(t,n){return e(function(e,t){return function(n){var a,r,s;return u.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,u.a.awrap(H.post("/login",{login:e,password:t}));case 3:return a=o.sent,n(le(a.data.token,a.data.userId)),r={token:a.data.token,userId:a.data.userId},localStorage.setItem("userInfo",JSON.stringify(r)),o.next=9,u.a.awrap(H.get("/users/".concat(a.data.userId)));case 9:s=o.sent,localStorage.setItem("user",JSON.stringify(s.data)),n(pe(s.data)),w.a.fire({icon:"success",title:"You are successfully logged in",showConfirmButton:!1,timer:2e3}),o.next=18;break;case 15:o.prev=15,o.t0=o.catch(0),I(o.t0,"Auth error");case 18:case"end":return o.stop()}}),null,null,[[0,15]])}}(t,n))},registerUser:function(t,n){return e(function(e,t){return function(n){var a,r,s;return u.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,u.a.awrap(H.post("/register",{login:e,password:t}));case 3:return a=o.sent,n(le(a.data.token,a.data.userId)),r={token:a.data.token,userId:a.data.userId},localStorage.setItem("userInfo",JSON.stringify(r)),o.next=9,u.a.awrap(H.get("/users/".concat(a.data.userId)));case 9:s=o.sent,localStorage.setItem("user",JSON.stringify(s.data)),n(pe(s.data)),w.a.fire({icon:"success",title:"Registration complete",showConfirmButton:!1,timer:2e3}),o.next=18;break;case 15:o.prev=15,o.t0=o.catch(0),I(o.t0,"Auth error");case 18:case"end":return o.stop()}}),null,null,[[0,15]])}}(t,n))}}}))(yt),Pt=n(273),xt=function(e){function t(){return Object(l.a)(this,t),Object(p.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props,t=e.component,n=e.admin,a=e.user,s=e.isLoggedIn,o=Object(Pt.a)(e,["component","admin","user","isLoggedIn"]);return r.a.createElement(c.b,Object.assign({},o,{render:function(e){return n?a.isAdmin?r.a.createElement(t,e):r.a.createElement(c.a,{to:"/404"}):s?r.a.createElement(t,e):r.a.createElement(c.a,{to:"/authorization"})}}))}}]),t}(a.Component);var jt=Object(h.b)((function(e){return{isLoggedIn:e.auth.isLoggedIn,user:e.auth.user}}))(xt);var St=function(e){function t(){return Object(l.a)(this,t),Object(p.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){this.props.getUser(this.props.match.params.id)}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(Oe,{title:"Posts maded by ".concat(this.props.user.login),subtitle:"Here you can see ".concat(this.props.user.login,"'s posts")}),r.a.createElement(ct,{id:this.props.match.params.id}))}}]),t}(a.Component);var Ht=Object(h.b)((function(e){return{user:e.users.user}}),(function(e){return{getUser:function(t){return e(function(e){return function(t){var n;return u.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,u.a.awrap(H.get("/users/".concat(e)));case 3:n=a.sent,t((r=n.data,{type:Y,user:r})),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),I(a.t0,"Get user error");case 10:case"end":return a.stop()}var r}),null,null,[[0,7]])}}(t))}}}))(St),It=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(p.a)(this,Object(d.a)(t).call(this,e))).onApproveHandle=function(e){n.props.approvePost(e)},n.onRemoveHandle=function(e){n.props.removePost(e)},n.setIsChecked=function(){n.setState({isChecked:!n.state.isChecked})},n.state={isChecked:!1},n}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(Oe,{title:"Admin Panel",subtitle:"Here you can approve or remove new posts or comments"}),r.a.createElement(kt,{isChecked:this.state.isChecked,setIsChecked:this.setIsChecked,left:"Comment",right:"Posts"}),this.state.isChecked?r.a.createElement(ct,{onApproveHandle:this.onApproveHandle,onRemoveHandle:this.onRemoveHandle,admin:!0}):r.a.createElement(se,{adminPanel:!0}))}}]),t}(a.Component);var Nt=Object(h.b)((function(e){return{singlePost:e.posts.singlePost}}),(function(e){return{approvePost:function(t){return e(function(e){return function(t){var n;return u.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,n={approved:!0},a.next=4,u.a.awrap(H.put("/posts/".concat(e),n));case 4:t(K()),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),I(a.t0,"Post approve error");case 10:case"end":return a.stop()}}),null,null,[[0,7]])}}(t))},removePost:function(t){return e(te(t))}}}))(It);var Ft=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(c.d,null,r.a.createElement(c.b,{exact:!0,path:"/",component:it}),r.a.createElement(c.b,{path:"/post/:id",component:Xe}),r.a.createElement(c.b,{path:"/authorization",component:wt}),r.a.createElement(jt,{path:"/my-posts",component:ut}),r.a.createElement(c.b,{path:"/user-posts/:id",component:Ht}),r.a.createElement(c.b,{path:"/post-edit/:id",component:ft}),r.a.createElement(jt,{admin:!0,path:"/admin",component:Nt}),r.a.createElement(c.a,{to:"/"})))},Tt=n(47),At={posts:[],singlePost:{},loading:!1};var Lt=localStorage.getItem("userInfo");Lt=JSON.parse(Lt)||{};var Rt=localStorage.getItem("user");Rt=JSON.parse(Rt)||{};var Bt={userId:Lt.userId,token:Lt.token,isLoggedIn:!!Lt.token,user:Rt};var Mt={user:{}};var Ut={comments:[]};var Dt=Object(Tt.c)({posts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:At,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N:return Object(pt.a)({},e,{loading:!0});case F:return Object(pt.a)({},e,{loading:!1,posts:t.posts});case T:return Object(pt.a)({},e,{loading:!0});case A:return Object(pt.a)({},e,{loading:!1,singlePost:t.singlePost});case L:return Object(pt.a)({},e,{loading:!1,error:t.error});case B:var n=e.singlePost.comments.slice();return n.push(t.comment),Object(pt.a)({},e,{singlePost:Object(pt.a)({},e.singlePost,{comments:n})});case M:return Object(pt.a)({},e,{singlePost:Object(pt.a)({},e.singlePost,{comments:e.singlePost.comments.filter((function(e){return e._id!==t.comment._id}))})});case U:var a=e.singlePost.likes.slice();return a.push(t.like),Object(pt.a)({},e,{singlePost:Object(pt.a)({},e.singlePost,{likes:a})});case D:return Object(pt.a)({},e,{singlePost:Object(pt.a)({},e.singlePost,{likes:e.singlePost.likes.filter((function(e){return e._id!==t.like._id}))})});case V:return Object(pt.a)({},e,{singlePost:Object(pt.a)({},e.singlePost,{},t.data)});default:return e}},auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Bt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case R:return Object(pt.a)({},e,{userId:t.payload.userId,token:t.payload.token,isLoggedIn:!!Lt.token});case z:return Object(pt.a)({},e,{userId:"",token:"",isLoggedIn:!1});case J:return Object(pt.a)({},e,{user:t.user});default:return e}},users:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Mt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Y:return Object(pt.a)({},e,{user:t.user});default:return e}},comments:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ut,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case G:return Object(pt.a)({},e,{comments:t.comments});case X:return Object(pt.a)({},e,{comments:e.comments.filter((function(e){return e._id!==t.id}))});case W:var n=e.comments.map((function(e){return e._id===t.id&&(e.approved=!0),e}));return Object(pt.a)({},e,{comments:n});default:return e}}}),zt=n(272);n.d(t,"store",(function(){return Yt}));var Vt="object"===typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({}):Tt.d,Yt=Object(Tt.e)(Dt,Vt(Object(Tt.a)(zt.a)));o.a.render(r.a.createElement(h.a,{store:Yt},r.a.createElement(_.a,null,r.a.createElement(Ft,null))),document.getElementById("root"))},70:function(e,t,n){e.exports={comment:"Comments_comment__13XYb",remove:"Comments_remove__30r7n",buttons:"Comments_buttons__3FWsz",main:"Comments_main__1MZE5"}},79:function(e,t,n){e.exports={main:"Header_main__2r9vH",small:"Header_small__1EU7f",h1:"Header_h1__31UXp",p:"Header_p__XPuGP"}},80:function(e,t,n){e.exports={main:"Menu_main__T4zCW",links:"Menu_links__LQVlq",close:"Menu_close__3Adea",burger:"Menu_burger__15Dyr"}}},[[275,1,2]]]);
//# sourceMappingURL=main.f53c8742.chunk.js.map